--1. Customers who have not placed any orders
SELECT c.CustomerName 
FROM Customers c
LEFT JOIN Orders o ON c.CustomersID = o.CustomerID
WHERE o.OrderID IS NULL;

--2. Total number of products available for sale
SELECT COUNT(*) AS TotalProducts FROM Products;

--3. Total revenue generated by TechShop
SELECT SUM(TotalAmount) AS TotalRevenue FROM Orders;

--4. Average quantity ordered for products in a specific category (Taking Category as an input)
SELECT AVG(od.Quantity) AS AvgQuantityOrdered
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
WHERE p.ProductName = 'Laptop';  -- Replace 'Laptop' with any category input

--5. Total revenue generated by a specific customer (Taking CustomerID as an input)
SELECT c.CustomerName, SUM(o.TotalAmount) AS CustomerRevenue
FROM Orders o
JOIN Customers c ON o.CustomerID = c.CustomersID
WHERE c.CustomersID = 101;  -- Replace 101 with the desired CustomerID

--6. Customers who have placed the most orders
SELECT c.CustomerName, COUNT(o.OrderID) AS NumberOfOrders
FROM Orders o
JOIN Customers c ON o.CustomerID = c.CustomersID
GROUP BY c.CustomerName
ORDER BY NumberOfOrders DESC
LIMIT 1;

--7. Most popular product category (Based on highest total quantity ordered)
SELECT p.ProductName, SUM(od.Quantity) AS TotalQuantityOrdered
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
GROUP BY p.ProductName
ORDER BY TotalQuantityOrdered DESC
LIMIT 1;

--8. Customer who spent the most on electronic gadgets
SELECT c.CustomerName, SUM(od.Quantity * od.Price) AS TotalSpent
FROM OrderDetails od
JOIN Orders o ON od.OrderID = o.OrderID
JOIN Customers c ON o.CustomerID = c.CustomersID
JOIN Products p ON od.ProductID = p.ProductID
WHERE p.ProductName IN ('Laptop', 'Smartphone', 'Headphones', 'Keyboard', 'Mouse')  -- Add relevant product names
GROUP BY c.CustomerName
ORDER BY TotalSpent DESC
LIMIT 1;

--9. Average order value (Total revenue divided by number of orders)
SELECT AVG(TotalAmount) AS AverageOrderValue FROM Orders;

